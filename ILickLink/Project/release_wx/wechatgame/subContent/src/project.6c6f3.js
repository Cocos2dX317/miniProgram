window.__require=function e(t,n,r){function a(i,c){if(!n[i]){if(!t[i]){var l=i.split("/");if(l=l[l.length-1],!t[l]){var s="function"==typeof __require&&__require;if(!c&&s)return s(l,!0);if(o)return o(l,!0);throw new Error("Cannot find module '"+i+"'")}}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){return a(t[i][1][e]||e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof __require&&__require,i=0;i<r.length;i++)a(r[i]);return a}({SubScene:[function(e,t,n){"use strict";cc._RF.push(t,"e44a5QBzFBBIYgEAiCPD134","SubScene"),Object.defineProperty(n,"__esModule",{value:!0});var r=function(){return function(e){this.fun_name="",this.res="",this.fun_name=e}}();n.WX_OpenData=r;var a=cc._decorator,o=a.ccclass,i=a.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rankScroll=null,t.rankItem=null,t.itemBg1=null,t.itemBg2=null,t.userInfo={nickName:"",openID:""},t}return __extends(t,e),t.prototype.start=function(){window.wx?this.onMessage():this.updateRankScroll([{nickname:"\u5f20\u4e09",avatarUrl:"",level:1},{nickname:"\u674e\u56db",avatarUrl:"",level:1},{nickname:"\u738b\u4e94",avatarUrl:"",level:1},{nickname:"\u6e9c\u6e9c",avatarUrl:"",level:1},{nickname:"\u4e03\u6740",avatarUrl:"",level:1},{nickname:"\u5df4\u62c9",avatarUrl:"",level:1},{nickname:"\u5c31\u6492\u65e6\u6cd5",avatarUrl:"",level:1},{nickname:"\u4e0a\u8bfe\u4e86\u7b49\u7ea7\u5206\u4e09\u4efd",avatarUrl:"",level:1},{nickname:"\u6848\u591a\u53d1\u53d1\u58eb\u5927\u592b\u6492\u901f\u5ea6",avatarUrl:"",level:1}])},t.prototype.updateRankScroll=function(e){console.info("\u66f4\u65b0\u5fae\u4fe1\u6392\u884c\u699c SubScene.updateRankScroll:",e);var t=this.rankScroll.getComponent(cc.ScrollView);if(t.content.removeAllChildren(),!(e.length<=0)){var n=this.rankItem.height+9;t.content.height=e.length*n;for(var r=0;r<e.length;r++){var a=e[r],o=cc.instantiate(this.rankItem);o.active=!0,t.content.addChild(o),o.setPosition(cc.v2(0,-r*n-n/2));var i=o.getChildByName("head");if(this.loadHttpIcon(i,a.avatarUrl,function(){}),o.getChildByName("name").getComponent(cc.Label).string=a.nickname,a.KVDataList){var c=JSON.parse(a.KVDataList[0].value);o.getChildByName("level").getComponent(cc.Label).string="\u5173\u5361:"+c.level}a.openid==this.userInfo.openID?o.getComponent(cc.Sprite).spriteFrame=this.itemBg2:a.nickname==this.userInfo.nickName?o.getComponent(cc.Sprite).spriteFrame=this.itemBg2:o.getComponent(cc.Sprite).spriteFrame=this.itemBg1}}},t.prototype.getRankInfo=function(e){for(var t=new Array,n=0;n<e.length;n++)e[n].KVDataList.length>0&&"ILickLink"==e[n].KVDataList[0].key&&t.push(e[n]);return t.sort(function(e,t){var n=JSON.parse(e.KVDataList[0].value),r=JSON.parse(t.KVDataList[0].value);return n.level>r.level?-1:1}),t},t.prototype.onMessage=function(){var e=this,t=this;window.wx.onMessage(function(n){if(console.log(n),"setUserCloudStorage"==n.fun_name)window.wx.setUserCloudStorage({KVDataList:[{key:"ILickLink",value:JSON.stringify(n.data)}],success:function(e){console.log(e)},fail:function(e){console.log(e)}});else if("getFriendCloudStorage"==n.fun_name)window.wx.getFriendCloudStorage({keyList:["ILickLink"],success:function(e){n.data&&(t.userInfo.openID=n.data.openID,t.userInfo.nickName=n.data.nickName),t.updateRankScroll(t.getRankInfo(e.data))},fail:function(e){console.error(e)}});else if("show"==n.fun_name){e.rankScroll.getComponent(cc.ScrollView).content.removeAllChildren()}else n.fun_name})},t.prototype.loadHttpIcon=function(e,t,n){t&&""!=t||(t="http://thirdwx.qlogo.cn/mmopen/vi_32/opmkDJhG2jpF8X8AfFQfTauRlpBc7VeFicJevZ9IiajEl5g4ia75opNSZOb0FvDV87BvpUN1rsyctibGnicP7uibsMtw/132"),cc.loader.load({url:t,type:"png"},function(t,r){var a=new cc.SpriteFrame(r);e.getComponent(cc.Sprite).spriteFrame=a,n&&n(),console.info("Should load a texture from RESTful API by specify the type: "+(r instanceof cc.Texture2D))})},__decorate([i(cc.Node)],t.prototype,"rankScroll",void 0),__decorate([i(cc.Node)],t.prototype,"rankItem",void 0),__decorate([i(cc.SpriteFrame)],t.prototype,"itemBg1",void 0),__decorate([i(cc.SpriteFrame)],t.prototype,"itemBg2",void 0),t=__decorate([o],t)}(cc.Component);n.default=c,cc._RF.pop()},{}]},{},["SubScene"]);